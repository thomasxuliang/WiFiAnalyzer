{
  "id": "snapshot_1764745594164_gxitommci",
  "approvalId": "approval_1764745594145_fuhsx5pr2",
  "approvalTitle": "WiFi Sniffer Tasks",
  "version": 1,
  "timestamp": "2025-12-03T07:06:34.164Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Tasks Document\r\n\r\n- [ ] 1. Create RootShellExecutor and Base Sniffer Architecture\r\n  - File: app/src/main/kotlin/com/vrem/wifianalyzer/wifi/sniffer/RootShellExecutor.kt\r\n  - File: app/src/main/kotlin/com/vrem/wifianalyzer/wifi/sniffer/SnifferManager.kt\r\n  - Create `RootShellExecutor` to handle `su` commands safely.\r\n  - Create `SnifferManager` singleton with a `SnifferState` sealed class (Idle, Capturing, Error).\r\n  - Purpose: Establish the foundation for privileged operations.\r\n  - _Leverage: java.lang.Runtime, java.io.DataOutputStream_\r\n  - _Requirements: Non-functional (Root Execution Isolation)_\r\n  - _Prompt: Role: Android System Developer | Task: Implement RootShellExecutor for executing su commands and a SnifferManager singleton with a basic state machine (Idle, Capturing) | Restrictions: Handle InterruptedException and IOExceptions gracefully | Success: RootShellExecutor can run a simple 'ls' command as root, SnifferManager compiles with state definitions_\r\n\r\n- [ ] 2. Implement SnifferManager Command Sequence\r\n  - File: app/src/main/kotlin/com/vrem/wifianalyzer/wifi/sniffer/SnifferManager.kt (Update)\r\n  - Implement `startCapture` logic with the wcn7750 specific sequence:\r\n    - `svc wifi disable`\r\n    - `ifconfig wlan0 down`\r\n    - `rmmod` / `insmod`\r\n    - `monitor_mode_channel`\r\n    - `tcpdump`\r\n  - Implement `stopCapture` to kill tcpdump.\r\n  - Purpose: Core business logic for the sniffer.\r\n  - _Leverage: RootShellExecutor_\r\n  - _Requirements: Requirement 1, Requirement 2, Requirement 3_\r\n  - _Prompt: Role: Android Driver/System Developer | Task: Implement the wcn7750 monitor mode command sequence in SnifferManager.startCapture, including disabling WiFi service and configuring the channel. Implement stopCapture to kill tcpdump. | Restrictions: Use the specific commands provided in the design. Ensure file paths for pcap are correct. | Success: startCapture executes the full sequence, stopCapture kills the process._\r\n\r\n- [ ] 3. Update UI with Start/Stop Button and Warning\r\n  - File: app/src/main/kotlin/com/vrem/wifianalyzer/wifi/accesspoint/AccessPointDetail.kt\r\n  - File: app/src/main/res/layout/access_point_view_complete.xml (or relevant layout)\r\n  - Add \"Start Sniffer\" button to the AP details view.\r\n  - Implement the Warning Dialog when clicked.\r\n  - Connect button to `SnifferManager.startCapture`.\r\n  - Purpose: Expose functionality to the user.\r\n  - _Leverage: Android AlertDialog, SnifferManager_\r\n  - _Requirements: Requirement 2, Non-functional (User Warning)_\r\n  - _Prompt: Role: Android UI Developer | Task: Add a 'Start Sniffer' button to the AccessPointDetail view. When clicked, show an AlertDialog warning about WiFi disconnection. On confirmation, call SnifferManager.startCapture. Update button state based on SnifferManager.isCapturing. | Restrictions: Match existing UI style. Ensure the button is only visible/active when appropriate. | Success: Button appears in AP list, Dialog shows up, Sniffer starts upon confirmation._\r\n",
  "fileStats": {
    "size": 2995,
    "lines": 37,
    "lastModified": "2025-12-03T07:06:25.654Z"
  },
  "comments": []
}